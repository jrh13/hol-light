#!/bin/sh
#Does not include theorem names with apostrophes
find . -name "*.[hm]l" -exec sed -i -n '1h;1!H;${;g;s/\n\(let\|and\)[ \n]*\([a-zA-Z0-9_-]*\)[ \n]*=[ \n]*\(prove\|prove_by_refinement\|new_definition\|new_basic_definition\|new_axiom\|define\|new_infix_definition\|INT_OF_REAL_THM\|define_finite_type\|TAUT\|INT_ARITH\)\([ \n(`]\)/\n\1 \2 = store_name \"\2\" \3\4/g;s/\nlet[ \n]*\([a-zA-Z0-9_-]*\)[ \n]*=[ \n]*\(new_recursive_definition\|new_specification\)/\nlet \1 = store_namea \"\1\" \2/g;s/\nlet[ \n]*\([a-zA-Z0-9_-]*\)[ \n]*,[ \n]*\([a-zA-Z0-9_-]*\)[ \n]*,[ \n]*\([a-zA-Z0-9_-]*\)[ \n]*=[ \n]*new_inductive_definition/\nlet \1,\2,\3 = store_name3 \"\1\" \"\2\" \"\3\" new_inductive_definition/g;s/\nlet[ \n]*\([a-zA-Z0-9_-]*\)[ \n]*,[ \n]*\([a-zA-Z0-9_-]*\)[ \n]*[ \n]*=[ \n]*\(define_type\|(CONJ_PAIR o prove)\)/\nlet \1,\2 = store_name2 \"\1\" \"\2\" \3/g;s/\nlet[ \n]*\([a-zA-Z0-9_-]*\)[ \n]*,[ \n]*\([a-zA-Z0-9_-]*\)[ \n]*[ \n]*=[ \n]*lift_function/\nlet \1,\2 = store_name2a \"\1\" \"\2\" lift_function/g;p;}' '{}' \;
